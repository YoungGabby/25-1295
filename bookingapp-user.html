<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jambostar Buses | Seat Selection</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .seat { width: 35px; height: 35px; cursor: pointer; transition: 0.2s; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; }
        .seat-available { background-color: #e2e8f0; border: 2px solid #cbd5e1; color: #64748b; }
        .seat-available:hover { background-color: #fcd34d; border-color: #fbbf24; color: #78350f; }
        .seat-selected { background-color: #3b82f6 !important; border-color: #2563eb !important; color: white !important; }
        .aisle { width: 40px; }
    </style>
</head>
<body class="bg-gray-100 font-sans">

    <nav class="bg-blue-900 text-white p-4 shadow-md">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-black tracking-tighter text-yellow-400">JAMBOSTAR BUSES</h1>
            <span class="text-sm bg-blue-800 px-3 py-1 rounded-full border border-blue-700">Capacity: 47 Seater</span>
			<span class="text-sm bg-blue-800 px-3 py-1 rounded-full border border-blue-700"><a href="bookingapp-admin.html">Login</a></span>
        </div>
    </nav>

    <main class="container mx-auto py-8 px-4 grid md:grid-cols-2 gap-10">
        
        <div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-200">
            <h2 class="text-lg font-bold mb-6 flex items-center gap-2">
                <span class="w-3 h-3 bg-yellow-400 rounded-full"></span> Select Your Seat (3 x 2 Layout)
            </h2>
            
            <div id="bus-layout" class="flex flex-col items-center gap-3">
                <script>
                    const rows = 9;
                    const container = document.getElementById('bus-layout');

                    // 1. GENERATE THE FRONT ROW (Row 0)
                    let frontRow = document.createElement('div');
                    frontRow.className = "flex gap-2 items-center mb-6 pb-4 border-b border-dashed border-gray-300 w-full justify-center";

                    // LEFT SIDE: Driver Seat aligned with ABC block
                    let driverBlock = document.createElement('div');
                    driverBlock.className = "w-[121px] flex justify-center"; // Total width of 3 seats (35*3 + 2*8 gap)
                    
                    let driverSeat = document.createElement('div');
                    driverSeat.className = "seat bg-gray-800 border-2 border-gray-900 text-white cursor-not-allowed";
                    driverSeat.innerHTML = "ðŸ›ž"; 
                    driverBlock.appendChild(driverSeat);
                    frontRow.appendChild(driverBlock);

                    // The Aisle
                    let frontAisle = document.createElement('div');
                    frontAisle.className = "aisle";
                    frontRow.appendChild(frontAisle);

                    // RIGHT SIDE: Two Passenger Seats (0D and 0E)
                    let rightFrontSide = document.createElement('div');
                    rightFrontSide.className = "flex gap-2";

                    ['0D', '0E'].forEach(id => {
                        let s = document.createElement('div');
                        s.className = "seat seat-available";
                        s.innerText = id;
                        s.onclick = () => selectSeat(s);
                        rightFrontSide.appendChild(s);
                    });
                    frontRow.appendChild(rightFrontSide);

                    container.appendChild(frontRow);

                    // 2. GENERATE STANDARD ROWS (1 to 9)
                    for (let r = 1; r <= rows; r++) {
                        let rowDiv = document.createElement('div');
                        rowDiv.className = "flex gap-2 items-center";
                        
                        ['A', 'B', 'C'].forEach(letter => {
                            let s = document.createElement('div');
                            s.className = "seat seat-available";
                            s.innerText = r + letter;
                            s.onclick = () => selectSeat(s);
                            rowDiv.appendChild(s);
                        });

                        let aisle = document.createElement('div');
                        aisle.className = "aisle";
                        rowDiv.appendChild(aisle);

                        ['D', 'E'].forEach(letter => {
                            let s = document.createElement('div');
                            s.className = "seat seat-available";
                            s.innerText = r + letter;
                            s.onclick = () => selectSeat(s);
                            rowDiv.appendChild(s);
                        });

                        container.appendChild(rowDiv);
                    }

                    function selectSeat(el) {
                        if (el.classList.contains('cursor-not-allowed')) return;
                        document.querySelectorAll('.seat').forEach(s => s.classList.remove('seat-selected'));
                        el.classList.add('seat-selected');
                        document.getElementById('selectedSeatInput').value = el.innerText;
                    }
                </script>
            </div>
            
            <div class="mt-8 flex justify-center gap-6 text-xs font-bold text-gray-500 border-t pt-4">
                <div class="flex items-center gap-2"><div class="w-4 h-4 bg-gray-200 rounded"></div> Available</div>
                <div class="flex items-center gap-2"><div class="w-4 h-4 bg-blue-500 rounded"></div> Selected</div>
                <div class="flex items-center gap-2"><div class="w-4 h-4 bg-gray-800 rounded"></div> Driver</div>
            </div>
        </div>

        <div class="space-y-6">
            <div class="bg-blue-900 text-white p-6 rounded-2xl shadow-lg">
                <h3 class="text-xl font-bold mb-4">Reservation Details</h3>
                <form id="bookingForm" class="space-y-4">
                    <div>
                        <label class="block text-xs uppercase font-bold text-blue-300 mb-1">Route & Price</label>
                        <select id="routeSelect" class="w-full bg-blue-800 border border-blue-700 p-3 rounded-lg text-white outline-none">
                            <option value="Syokimau">Daystar Athi âž” Syokimau (Ksh 150)</option>
                            <option value="Nairobi">Daystar Athi âž” Nairobi (Ksh 200)</option>
							<option value="SyokimauAthi">Syokimau âž” Daystar Athi (Ksh 150)</option>
                            <option value="NairobiAthi">Nairobi âž” Daystar Athi (Ksh 200)</option>
                        </select>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs uppercase font-bold text-blue-300 mb-1">Departure Time</label>
                            <select id="timeSelect" class="w-full bg-blue-800 border border-blue-700 p-3 rounded-lg text-white outline-none">
                                <option>3:00 PM</option>
                                <option>5:00 PM</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs uppercase font-bold text-blue-300 mb-1">Your Seat</label>
                            <input id="selectedSeatInput" required type="text" readonly placeholder="Pick a seat" class="w-full bg-yellow-400 border-none p-3 rounded-lg text-blue-900 font-black text-center outline-none">
                        </div>
                    </div>

                    <div class="pt-4">
                        <label class="block text-xs uppercase font-bold text-blue-300 mb-1">Full Name</label>
                        <input id="userName" type="text" class="w-full bg-blue-800 border border-blue-700 p-3 rounded-lg text-white outline-none" placeholder="Student Name"  required>
                    </div>

                    <button id="myButton" type="button" class="w-full bg-yellow-400 hover:bg-white text-blue-900 font-black py-4 rounded-xl transition-all shadow-xl mt-4">
                        BOOK MY SEAT NOW
                    </button>
					<p id="output"></p>
					<p id="infonext" style="color:red; font-style:bold;"></p>
                </form>
            </div>
			<p id="infonext2" style="color:red; font-style:bold; float:right;"></p>
			<div id="areaToPrint" class="bg-blue-900 text-white p-6 rounded-2xl shadow-lg">
    <style id="table_style">
        /* Add CSS styles here that you want applied to the printout */
        table {
            border: 1px solid #ccc;
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            padding: 8px;
            text-align: left;
            border: 1px solid #ccc;
        }
        th {
            background-color: #f7f7f7;
        }
		margin-top :20px;
    </style>
			
    <div id="table-container">
        <!-- The table will be generated here by JavaScript -->
    </div>
			</div>
						<p id="footer" style="color:red; font-style:bold; float:right;"></p>

        </div>
    </main>

    <script>

	
	
// Disable Booking button until all fields are selected.	
document.getElementById("myButton").disabled = true;

// Get references to the elements
const myButton = document.getElementById('myButton');
const myuserName = document.getElementById('userName');
const myInput = document.getElementById('userName');
const output = document.getElementById('output');
const infonext = document.getElementById('infonext');
const infonext2 = document.getElementById('infonext2');
const footer = document.getElementById('footer');
const myRoute = document.getElementById('routeSelect');
const mySeat = document.getElementById('selectedSeatInput');
const ticket = document.getElementById('ticket');
const busTime = document.getElementById('timeSelect');


let route = myRoute.value;
let bus;
let fareamount;

switch (route) {
    case "Syokimau":
        bus = "KDY 001B";
		fareamount = 150;
		destination = "Syokimau";
        break;
    case "Nairobi":
        bus = "KDZ 001A";
		fareamount = 200;
		destination = "Nairobi";
        break;
	case "SyokimauAthi":
        bus = "KDY 001B";
		fareamount = 150;
		destination = "Daystar Athi";
        break;
    case "NairobiAthi":
        bus = "KDZ 001A";
		fareamount = 200;
		destination = "Daystar Athi";
        break;
    default:
        bus = "Error finding your bus, contact the office";
		fareamount = "Error finding your fare, contact the office" ;
}
    
	
function tripSummary() {
	 
	const today = new Date();
	let dd = today.getDate();
	let mm = today.getMonth() + 1; // Month is 0-indexed
	const yyyy = today.getFullYear();
	let formattedDate = mm + '/' + dd + '/' + yyyy;
	
	let myTitle = 'JAMBO BUS BOOKING SERVICE';
    let myuserNameValue = 'Student Names : ' + myuserName.value;
	let routeValue = 'Bus route : ' + myRoute.value;
	let datedeptValue = 'Date of Depature : ' + formattedDate;
    let busNumberValue = 'Bus Number : ' + bus;
	let busTimeValue = 'Depature Time : ' + busTime;
	let mySeatValue = 'Seat Number : ' + mySeat.value;
	let mypriceValue = 'Bus Fare : ' + fareamount;
	let mydestinationValue = 'Destination : ' + destination;
 const data = [
 
    { name: datedeptValue },
	{ name: myuserNameValue },
    { name: busNumberValue },
    { name: mySeatValue },
	{ name: mydestinationValue },
    { name: busNumberValue },
	{ name: routeValue },
    { name: mypriceValue },

];

function createTableHTML(data) {
    const tableContainer = document.getElementById("table-container");

    let tableHTML = `
	<h1 class="text-xl font-bold mb-4">JAMBO BUS BOOKING SERVICE</h1>
        <table id="printTable">
            
            <tbody>
    `;

    data.forEach(item => {
        tableHTML += `
            <tr>
                <td>${item.name}</td>
                
            </tr>
        `;
    });

    tableHTML += `
            </tbody>
        </table>
    `;

    tableContainer.innerHTML = tableHTML;
}

createTableHTML(data);

infonext2.textContent = " Press CTRL + Q (to print your ticket)" 
footer.textContent = " Press CTRL + L (to book another seat)"
}

function handleAction() {


    const inputValue = myuserName.value;
	
	if (inputValue === ""){
	
	alert("Please enter your full names");
	
	}else{
	output.textContent = "You have successfully booked Seat No: " + inputValue ;
    infonext.textContent = " Press CTRL + D to view ticket details of your trip"

	}
	
      
}

function mySeatcheck(){
    const inputValue = mySeat.value;
	if (inputValue === ""){
	
	alert("You must select a seat to proceed");
	
	}else{
	document.getElementById("myButton").disabled = false;
	}
	

}
myuserName.addEventListener('click', mySeatcheck);	
// 1. Add a click event listener to the button

myButton.addEventListener('click', handleAction);	   

document.addEventListener('keydown', function(e) {
    // Check for Ctrl (Windows/Linux) or Cmd (Mac) key pressed
    if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
        e.preventDefault(); // Prevent the browser's default save dialog
        tripSummary(); // Call your custom save function
    }
});	   


function printTableContent() {
    var divToPrint = document.getElementById("areaToPrint");
    // Open a new window
    newWin = window.open("");
    // Write the content to the new window's document
    newWin.document.write('<html><head><title>Print Ticket</title>');
    // Optionally, include external CSS files or inline styles
    // newWin.document.write('<link rel="stylesheet" href="style.css">'); 
    newWin.document.write('</head><body>');
    newWin.document.write(divToPrint.outerHTML); // Use outerHTML to include the container div and its styles
    newWin.document.write('</body></html>');
    newWin.document.close(); // Close the document to ensure all content is loaded
    // Trigger the print dialog
    newWin.print();
    // Close the new window after printing (optional, can be commented out to keep the preview open)
    newWin.close();
}	

document.addEventListener('keydown', function(e) {
    // Check for Ctrl (Windows/Linux) or Cmd (Mac) key pressed
    if ((e.ctrlKey || e.metaKey) && e.key === 'q') {
        e.preventDefault(); // Prevent the browser's default save dialog
        printTableContent(); // Call print function
		
    }
});	   
   
document.addEventListener('keydown', function(e) {
    // Check for Ctrl (Windows/Linux) or Cmd (Mac) key pressed
    if ((e.ctrlKey || e.metaKey) && e.key === 'l') {
        e.preventDefault(); // Prevent the browser's default save dialog
        window.location.reload();; // reload page to book another seat
		
    }
});	   
   
    </script>
	
</body>
</html>
